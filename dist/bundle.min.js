!function(){"use strict";var s,u;function c(e){return e.properties.osm_value}function p(n){return function(e){var t=e.properties.name,r=n(e);return r&&(t+=", "+r),e.properties.city&&e.properties.city!==e.properties.name&&(t+=", "+e.properties.city),e.properties.country&&(t+=", "+e.properties.country),t}}s=jQuery,u=Bloodhound,(void 0).PhotonAddressEngine=function(e){var t=(e=e||{}).formatType||c,r=e.formatResult||p(t),n=e.url||"http://photon.komoot.io",t=e.limit||5,o={};e.lat&&e.lon&&(o.lat=e.lat,o.lon=e.lon),e.lang&&(o.lang=e.lang),o.limit=t;var i=new u({local:[],queryTokenizer:u.tokenizers.nonword,datumTokenizer:function(e){return u.tokenizers.obj.whitespace(["country","city","postcode","name","state"])(e.properties)},identify:function(e){return e.properties.osm_id},remote:{url:n+"/api/",sufficient:t,prepare:function(e,t){return t.data=o,t.data.q=e,t},transform:function(e){return e.features.forEach(function(e){e.description=r(e)}),e.features||[]}}}),a=i.search;return i.search=function(e,n,o){var t=jQuery.Deferred(),r=jQuery.Deferred();a.call(i,e,function(e){t.resolve(e)},function(e){r.resolve(e)}),s.when(t,r).then(function(e,t){var r=[].concat(e,t);s(i).trigger("addresspicker:predictions",[r]),n(e),o(t)})},i.bindDefaultTypeaheadEvent=function(e){e.bind("typeahead:selected",function(e,t){s(i).trigger("addresspicker:selected",[t])})},i.reverseGeocode=function(e){s.get(n+"/reverse",{lat:e[0],lon:e[1]}).then(function(e){e.features&&((e=e.features[0]).description=r(e),s(i).trigger("addresspicker:selected",[e]))})},i.__testonly__={},i.__testonly__.defaultFormatType=c,i.__testonly__.defaultFormatResult=p(c),i}}();
